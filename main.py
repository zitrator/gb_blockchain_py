import hashlib

# Что нужно сделать:
# Параметры: n = 32 (биты),
# хэш-функция H = первые 4 байта SHA1 (sha1( input ).digest()[ : 4 ]),
# подпись - конкатенация 32 строк, каждая длины 4 байта.
#
# Для каких из следующих сообщений приведена корректная подпись (дан открытый ключ pk, сообщение message
# и его подпись signature):


pk1 = [['\xfb5\xadY', '\xa5\xb6Q&'], ['sP\x88\xe9', '\xb1\xdaj\x9c'], ['W\x7f3$', '\xb5\xca}\x14'],
       ['\x81\x06\xcb#', 'x]u*'], ['\xe6\r\xba%', '\x8a\x03\x8b\xee'], ['%\x07\x84\xdf', '\x9a_i^'],
       ['\xe9\xe1\x05A', '\xc8\xab\xfd\x18'], ['\xe0W\x80\x83', '\x9a4>f'], ['\xaa\xba>\xf9', '\xf40\x87G'],
       ['\xd7\xf23\x02', '\xbc\xf7\x89\xf6'], ['Y\n,\x88', '\xa2\xde@\xab'], ['\xfbV*\x13', 'Qc\xb0q'],
       ['\xeby]}', '\xd5N\x9b\xe2'], ['_\x9a\x17W', 'c8\xd4\x80'], ['e)\xf1\xda', '\xe1\x8e#\xca'],
       ['P\xaf\xab\x97', 'd\xd2A#'], ['_\xcf\xb4\x1b', '<\x97\x8a\x13'], ['\x9e\xc8[\xc4', '.\xf2\xf9z'],
       ['\xc1!\xd6\x1a', '\xe9rI\xe0'], ['\xcdW\xb9\xa8', '@\x19\x9c\xf2'], ['\x91\xfdyC', '7\xdeFB'],
       ['\xcd\x16\x050', 'Y/\x8f\xea'], ['\xc3\xe7(\x05', '[Q0\x16'], ['!\x8cE\xde', '\xf9J\xc4c'],
       ['\x93%\x9f\\', '\xcd\x97\xd5k'], ['\xc6\x9ao{', '\xff\xb2\x1bm'], ['c\xb9C\x9f', '\xd9\xaa\x7f0'],
       ['\xf6\xad\xb0r', 'p\xfe\xe8\r'], ['v\x83z\xe4', 'sr\x08\xdf'], ['S\xe7U\x1b', '!m\xbe2'],
       ['\xdcy\x9a%', '\xe2\xbev%'], ['?^@n', ']\t\x1f\xca']]
message1 = 'Privet!!!'
signature1 = '?\xad\xa8Z\xa3\xf3,\xfa\xdf@@ _\x8d\x9dO8\xc1\xf7\xf2\x15\xa9\x89\xb8\x92\x98q+P\x9e\x04\xf6\x05\xc7\xc0~\xab\xd4\xfdq!L\xce}\x18#DJ\x11\x0b"\x9c@\xdcQ\x9f\x9b\xe0\xac7\xa6\xe9\x91w\xc4\x94\xeb>\xab\xfa\x8e\xc0S\x93JH9\xc2\x93\xbcI\x0e=:\x98\xaf\xe9\x93\xcb\xe0\xf4mU\xdf\x8d\x9b\xd7\xa7\xe1\x0czVkpN\x14\x0e\x92\xf4\x07\x0b\xb7\x16\xd4<p\x92G9#\x02\xedI\xf4w\x9f\x1aq'

pk2 = [['\xfb5\xadY', '\xa5\xb6Q&'], ['sP\x88\xe9', '\xb1\xdaj\x9c'], ['W\x7f3$', '\xb5\xca}\x14'],
       ['\x81\x06\xcb#', 'x]u*'], ['\xe6\r\xba%', '\x8a\x03\x8b\xee'], ['%\x07\x84\xdf', '\x9a_i^'],
       ['\xe9\xe1\x05A', '\xc8\xab\xfd\x18'], ['\xe0W\x80\x83', '\x9a4>f'], ['\xaa\xba>\xf9', '\xf40\x87G'],
       ['\xd7\xf23\x02', '\xbc\xf7\x89\xf6'], ['Y\n,\x88', '\xa2\xde@\xab'], ['\xfbV*\x13', 'Qc\xb0q'],
       ['\xeby]}', '\xd5N\x9b\xe2'], ['_\x9a\x17W', 'c8\xd4\x80'], ['e)\xf1\xda', '\xe1\x8e#\xca'],
       ['P\xaf\xab\x97', 'd\xd2A#'], ['_\xcf\xb4\x1b', '<\x97\x8a\x13'], ['\x9e\xc8[\xc4', '.\xf2\xf9z'],
       ['\xc1!\xd6\x1a', '\xe9rI\xe0'], ['\xcdW\xb9\xa8', '@\x19\x9c\xf2'], ['\x91\xfdyC', '7\xdeFB'],
       ['\xcd\x16\x050', 'Y/\x8f\xea'], ['\xc3\xe7(\x05', '[Q0\x16'], ['!\x8cE\xde', '\xf9J\xc4c'],
       ['\x93%\x9f\\', '\xcd\x97\xd5k'], ['\xc6\x9ao{', '\xff\xb2\x1bm'], ['c\xb9C\x9f', '\xd9\xaa\x7f0'],
       ['\xf6\xad\xb0r', 'p\xfe\xe8\r'], ['v\x83z\xe4', 'sr\x08\xdf'], ['S\xe7U\x1b', '!m\xbe2'],
       ['\xdcy\x9a%', '\xe2\xbev%'], ['?^@n', ']\t\x1f\xca']]
message2 = 'Hello!!!'
signature2 = '\xe0/\xcc"h\xdc>\xc0R\x0f6c/\x88\x00\xbb\xfa\xc3\xdd\x99w\x15\xc37%\xb9\xe8\xcb\xa3\xbab\xf2\x8c\xdd\x95$\xdf\x01\x8ba\'\xe9\xe0T\x82 \xa5\xe8\x9cs\xfaC_xr\xca\xedK\x03\xbb\xb0\x9a\xd77\xf3u\xf0;\xbf+\x0e\xff\xa6\xf8?F\xdc\x94\xe6\xf4\xefc\x8e\xd14\x9b<\x94q\x97\xb7M\x1c&r58\x8d^2\xaa\xc1\xac\xdd\x04\xe7z|$I2\xa9\xce\x81\xccU\xd8\xaa\xfa\xc8$\x1f\x1bM\x99[\x19\x11'

pk3 = [['\xe3+\xbf\xec', 'm\xb42\xea'], ['\xa2\xb8AY', 'N\xd3\x17^'], ['\xc2\xb2\x0c\xa8', 's\xde\xcdE'],
       ['n\xf0$\x9c', '\xf1\xc0?\xbc'], ['\xbc\xb4\x95\xf0', 'D_\xc3\xb8'], ['\x11\x12\r\x94', '=\xa7\x80\xd1'],
       ['\x9c\xd2L\x95', 'jC\xf2\xad'], ['\xf5\xc7*\xd0', '\xdef\x0f\x9f'], ['\x88\x96{\xae', '\xee$\x96\xd0'],
       ['\xf7\xef\x8d"', '\x87\x8c\xe6\x8a'], ['\x17\xb6H\xa4', 'd\xc6\x9d\x7f'], ['Q0\xa6\xc8', '\xcf;;\x1c'],
       ['\x9d\x03\xb3K', 'z\xd9\x11\xa0'], [';|/\xb3', '\xb4\x96\x0e&'], ['\x90\xbe\x05\xbc', '\x9d_\x9cE'],
       ['P\xdc\xc0\xa4', '?\x88\xb5z'], ['\x1e\x0e\xe5\xc4', '\x97\x1c\x166'], [')P\xacZ', '\x0b\xac\x9f\x1f'],
       ['\xfef|\xdc', '\xea\x0b\x85\xe4'], ['\xec\xee\n\x8e', 'I\x9d+\x87'], ['A\x91\x91J', 'n\x85I;'],
       ['\x1a\t\xf9C', '\xe0\x7f\xd7H'], ['\x90+\xc8\x85', '\xf2RIM'], ['t\xe7\\\xc5', '\xc4\xe9PO'],
       ['\x83\xe4\x1a2', '^\xb9:F'], ['\x13\xb1t.', '\x9a.]\xb6'], ['d\xdf\x0e\xd5', 'v\xf8\xe3\xac'],
       ['\x84\xc4*U', '\xb6I\xc3\xe2'], ['G\xff\xbf\xca', '\xf8;\x8fc'], ['\x91 \xcf\x00', '/D\x0eB'],
       ['\x7fK\xd5j', '~\x15rk'], ['\xb0\xd9\xf8\xac', '\xd3\xaet5']]
message3 = 'Blockchain!'
signature3 = '\xad\x9e9i\x82jM\x86 UP72\x0b\xc1w\xb1\x08\x8a$q\xe1\xf4\x17\x19\xb0\xa0n\xe46\x19\xbd\xc6\xeb\xad\xe8d\xc0\xfdPZ\x14\x01\n\xaf\x8a\x18UP\xaf>"\xe3\x906?\xc2T\xe5\x08\x86j\xbau\xfd\xe2\xd0w\xf0\x14Q\xf8\x04}T\x81uz*s\xda\x99\xc4">5\xb3\xc0\x8f\x81\x18\xe4\xbe\x06=2\xde!\x17\xaf&\xd8\xf0\xdb\xf1|D\x1f\x14\xa2\x8c\xd5\x86\xaf\x1f\x89\x08\xac\x96\x00w\x1d\xb9\xceq\x04\x88D'


# binary string
def bstr(n): # n in range 0-255
    return ''.join([str(n >> x & 1) for x in (7, 6, 5, 4, 3, 2, 1, 0)])


def make_signature(msg, pk):
    hash_msg = hashlib.sha1(msg.encode('windows-1251')).digest()[:4]
    print(bstr(hash_msg[0]) + ' ' + bstr(hash_msg[1]) + ' ' + bstr(hash_msg[2]) + ' ' + bstr(hash_msg[3]))
    r = 11 >> hash_msg[0] & 1
    print(r)


def task_three():
    print()
    make_signature(message1, pk1)


if __name__ == '__main__':
    task_three()
